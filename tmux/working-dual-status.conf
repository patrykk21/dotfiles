# =====================================
# WORKING DUAL STATUS BARS
# =====================================
# Since tmux can't have true separate top/bottom bars,
# this solution uses status at top for tabs and 
# the command-message area for bottom status

# Top status bar for window tabs
set -g status on
set -g status-position top
set -g status-justify centre
set -g status-bg "colour235"
set -g status-fg "colour250"

# Window tabs
set -g window-status-format "#[fg=colour250,bg=colour236] #I #[fg=colour243]#W "
set -g window-status-current-format "#[fg=colour235,bg=colour114] #I #[fg=colour235,bold]#W "
set -g window-status-separator ""
set -g status-left " "
set -g status-right "#[fg=colour243,bg=colour235] #S "

# No pane borders
set -g pane-border-status off

# =====================================
# BOTTOM BAR USING PERSISTENT MESSAGE
# =====================================

# Style the message bar to match status
set -g message-style "bg=colour235,fg=colour250,align=centre"
set -g message-command-style "bg=colour235,fg=colour250,align=centre"

# Function to show bottom status
bind-key -n M-b run-shell 'tmux display-message -d 0 "$(~/.config/tmux/scripts/status-bar.sh | sed "s/#\\[[^]]*\\]//g")"'

# Auto-refresh bottom bar
set-hook -g after-new-window 'run-shell "tmux display-message -d 86400 \"$(~/.config/tmux/scripts/status-bar.sh | sed \"s/#\\[[^]]*\\]//g\")\""'
set-hook -g after-select-pane 'run-shell "tmux display-message -d 86400 \"$(~/.config/tmux/scripts/status-bar.sh | sed \"s/#\\[[^]]*\\]//g\")\""'
set-hook -g client-session-changed 'run-shell "tmux display-message -d 86400 \"$(~/.config/tmux/scripts/status-bar.sh | sed \"s/#\\[[^]]*\\]//g\")\""'

# Initialize on load
run-shell 'tmux display-message -d 86400 "$(~/.config/tmux/scripts/status-bar.sh | sed "s/#\\[[^]]*\\]//g")"'